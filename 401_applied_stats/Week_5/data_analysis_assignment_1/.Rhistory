#adults_df["SEX"][adults_df["SEX"] == "F"] <- "ADULT"
#adults_df["SEX"][adults_df["SEX"] == "M"] <- "ADULT"
infant_vol_by_ring <- ggplot(data=infants_df,aes(x=RINGS,y=VOLUME)) +
geom_boxplot() +
ylim = c(0,1100)
newdata <- mydata[mydata$RINGS<16,]
infants_df <- newdata[newdata$SEX == 'I',]
infants_df <- droplevels(infants_df)
adults_df <- newdata[newdata$SEX %in% c('F','M'),]
adults_df <- droplevels(adults_df)
#adults_df["SEX"][adults_df["SEX"] == "F"] <- "ADULT"
#adults_df["SEX"][adults_df["SEX"] == "M"] <- "ADULT"
infant_vol_by_ring <- ggplot(data=infants_df,aes(x=RINGS,y=VOLUME)) +
geom_boxplot() +
ylim(c(0,1100))
infant_vol_by_ring
newdata <- mydata[mydata$RINGS<16,]
infants_df <- newdata[newdata$SEX == 'I',]
infants_df <- droplevels(infants_df)
adults_df <- newdata[newdata$SEX %in% c('F','M'),]
adults_df <- droplevels(adults_df)
#adults_df["SEX"][adults_df["SEX"] == "F"] <- "ADULT"
#adults_df["SEX"][adults_df["SEX"] == "M"] <- "ADULT"
infant_vol_by_ring <- ggplot(data=infants_df,aes(x=RINGS,y=VOLUME, group=RINGS)) +
geom_boxplot() +
ylim(c(0,1100))
infant_vol_by_ring
newdata <- mydata[mydata$RINGS<16,]
infants_df <- newdata[newdata$SEX == 'I',]
infants_df <- droplevels(infants_df)
adults_df <- newdata[newdata$SEX %in% c('F','M'),]
adults_df <- droplevels(adults_df)
#adults_df["SEX"][adults_df["SEX"] == "F"] <- "ADULT"
#adults_df["SEX"][adults_df["SEX"] == "M"] <- "ADULT"
infant_vol_by_ring <- ggplot(data=infants_df,aes(x=RINGS,y=VOLUME, group=RINGS)) +
geom_boxplot(outliers.color = 'white') +
ylim(c(0,1100))
infant_vol_by_ring
newdata <- mydata[mydata$RINGS<16,]
infants_df <- newdata[newdata$SEX == 'I',]
infants_df <- droplevels(infants_df)
adults_df <- newdata[newdata$SEX %in% c('F','M'),]
adults_df <- droplevels(adults_df)
#adults_df["SEX"][adults_df["SEX"] == "F"] <- "ADULT"
#adults_df["SEX"][adults_df["SEX"] == "M"] <- "ADULT"
infant_vol_by_ring <- ggplot(data=infants_df,aes(x=RINGS,y=VOLUME, group=RINGS)) +
geom_boxplot(color='blue') +
ylim(c(0,1100))
infant_vol_by_ring
infant_vol_by_ring <- ggplot(data=infants_df,aes(x=RINGS,y=VOLUME, group=RINGS, fill=RINGS)) +
geom_boxplot(color='blue') +
ylim(c(0,1100))
newdata <- mydata[mydata$RINGS<16,]
infants_df <- newdata[newdata$SEX == 'I',]
infants_df <- droplevels(infants_df)
adults_df <- newdata[newdata$SEX %in% c('F','M'),]
adults_df <- droplevels(adults_df)
#adults_df["SEX"][adults_df["SEX"] == "F"] <- "ADULT"
#adults_df["SEX"][adults_df["SEX"] == "M"] <- "ADULT"
infant_vol_by_ring <- ggplot(data=infants_df,aes(x=RINGS,y=VOLUME, group=RINGS, fill=RINGS)) +
geom_boxplot(color='blue') +
ylim(c(0,1100))
infant_vol_by_ring
newdata <- mydata[mydata$RINGS<16,]
infants_df <- newdata[newdata$SEX == 'I',]
infants_df <- droplevels(infants_df)
adults_df <- newdata[newdata$SEX %in% c('F','M'),]
adults_df <- droplevels(adults_df)
#adults_df["SEX"][adults_df["SEX"] == "F"] <- "ADULT"
#adults_df["SEX"][adults_df["SEX"] == "M"] <- "ADULT"
infant_vol_by_ring <- ggplot(data=infants_df,aes(x=RINGS,y=VOLUME, group=RINGS, fill='blue')) +
geom_boxplot() +
ylim(c(0,1100))
infant_vol_by_ring
newdata <- mydata[mydata$RINGS<16,]
infants_df <- newdata[newdata$SEX == 'I',]
infants_df <- droplevels(infants_df)
adults_df <- newdata[newdata$SEX %in% c('F','M'),]
adults_df <- droplevels(adults_df)
#adults_df["SEX"][adults_df["SEX"] == "F"] <- "ADULT"
#adults_df["SEX"][adults_df["SEX"] == "M"] <- "ADULT"
infant_vol_by_ring <- ggplot(data=infants_df,aes(x=RINGS,y=VOLUME, group=RINGS)) +
geom_boxplot(fill='blue') +
ylim(c(0,1100))
infant_vol_by_ring
newdata <- mydata[mydata$RINGS<16,]
infants_df <- newdata[newdata$SEX == 'I',]
infants_df <- droplevels(infants_df)
adults_df <- newdata[newdata$SEX %in% c('F','M'),]
adults_df <- droplevels(adults_df)
#adults_df["SEX"][adults_df["SEX"] == "F"] <- "ADULT"
#adults_df["SEX"][adults_df["SEX"] == "M"] <- "ADULT"
infant_vol_by_ring <- ggplot(data=infants_df,aes(x=RINGS,y=VOLUME, group=RINGS)) +
geom_boxplot(fill='lightblue') +
ylim(c(0,1100))
infant_vol_by_ring
newdata <- mydata[mydata$RINGS<16,]
infants_df <- newdata[newdata$SEX == 'I',]
infants_df <- droplevels(infants_df)
adults_df <- newdata[newdata$SEX %in% c('F','M'),]
adults_df <- droplevels(adults_df)
#adults_df["SEX"][adults_df["SEX"] == "F"] <- "ADULT"
#adults_df["SEX"][adults_df["SEX"] == "M"] <- "ADULT"
infant_vol_by_ring <- ggplot(data=infants_df,aes(x=RINGS,y=VOLUME, group=RINGS)) +
geom_boxplot(fill='lightblue') +
ylim(c(0,1100)) +
labs(title = 'Mean Volume per CLASS') +
theme(plot.title = element_text(hjust = 0.5))
infant_vol_by_ring
newdata <- mydata[mydata$RINGS<16,]
infants_df <- newdata[newdata$SEX == 'I',]
infants_df <- droplevels(infants_df)
adults_df <- newdata[newdata$SEX %in% c('F','M'),]
adults_df <- droplevels(adults_df)
#adults_df["SEX"][adults_df["SEX"] == "F"] <- "ADULT"
#adults_df["SEX"][adults_df["SEX"] == "M"] <- "ADULT"
infant_vol_by_ring <- ggplot(data=infants_df,aes(x=RINGS,y=VOLUME, group=RINGS)) +
geom_boxplot(fill='lightblue') +
ylim(c(0,1100)) +
labs(title = 'Infant Volume | Rings') +
theme(plot.title = element_text(hjust = 0.5))
infant_vol_by_ring
newdata <- mydata[mydata$RINGS<16,]
infants_df <- newdata[newdata$SEX == 'I',]
infants_df <- droplevels(infants_df)
adults_df <- newdata[newdata$SEX %in% c('F','M'),]
adults_df <- droplevels(adults_df)
#adults_df["SEX"][adults_df["SEX"] == "F"] <- "ADULT"
#adults_df["SEX"][adults_df["SEX"] == "M"] <- "ADULT"
infant_vol_by_ring <- ggplot(data=infants_df,aes(x=RINGS,y=VOLUME, group=RINGS)) +
geom_boxplot(fill='lightblue') +
ylim(c(0,1100)) +
labs(title = 'Infant Volume | Rings') +
theme(plot.title = element_text(hjust = 0.5))
adult_vol_by_ring <- ggplot(data=adults_df,aes(x=RINGS,y=VOLUME, group=RINGS)) +
geom_boxplot(fill='lightblue') +
ylim(c(0,1100)) +
labs(title = 'Adult Volume | Rings') +
theme(plot.title = element_text(hjust = 0.5))
infant_vol_by_ring <- ggplot(data=infants_df,aes(x=WHOLE,y=VOLUME, group=RINGS)) +
geom_boxplot(fill='lightblue') +
ylim(c(0,400)) +
labs(title = 'Infant Whole Weight | Rings') +
theme(plot.title = element_text(hjust = 0.5))
adult_vol_by_ring <- ggplot(data=adults_df,aes(x=WHOLE,y=VOLUME, group=RINGS)) +
geom_boxplot(fill='lightblue') +
ylim(c(0,400)) +
labs(title = 'Adult Whole Weight | Rings') +
theme(plot.title = element_text(hjust = 0.5))
grid.arrange(infant_vol_by_ring,adult_vol_by_ring,infant_vol_by_ring,adult_vol_by_ring,ncol=2,nrow=2)
newdata <- mydata[mydata$RINGS<16,]
infants_df <- newdata[newdata$SEX == 'I',]
infants_df <- droplevels(infants_df)
adults_df <- newdata[newdata$SEX %in% c('F','M'),]
adults_df <- droplevels(adults_df)
#adults_df["SEX"][adults_df["SEX"] == "F"] <- "ADULT"
#adults_df["SEX"][adults_df["SEX"] == "M"] <- "ADULT"
infant_vol_by_ring <- ggplot(data=infants_df,aes(x=RINGS,y=VOLUME, group=RINGS)) +
geom_boxplot(fill='lightblue') +
ylim(c(0,1100)) +
labs(title = 'Infant Volume | Rings') +
theme(plot.title = element_text(hjust = 0.5))
adult_vol_by_ring <- ggplot(data=adults_df,aes(x=RINGS,y=VOLUME, group=RINGS)) +
geom_boxplot(fill='lightblue') +
ylim(c(0,1100)) +
labs(title = 'Adult Volume | Rings') +
theme(plot.title = element_text(hjust = 0.5))
infant_weight_by_ring <- ggplot(data=infants_df,aes(x=WHOLE,y=VOLUME, group=RINGS)) +
geom_boxplot(fill='lightblue') +
ylim(c(0,400)) +
labs(title = 'Infant Whole Weight | Rings') +
theme(plot.title = element_text(hjust = 0.5))
adult_weight_by_ring <- ggplot(data=adults_df,aes(x=WHOLE,y=VOLUME, group=RINGS)) +
geom_boxplot(fill='lightblue') +
ylim(c(0,400)) +
labs(title = 'Adult Whole Weight | Rings') +
theme(plot.title = element_text(hjust = 0.5))
grid.arrange(infant_vol_by_ring,adult_vol_by_ring,infant_vol_by_ring,adult_vol_by_ring,ncol=2,nrow=2)
newdata <- mydata[mydata$RINGS<16,]
infants_df <- newdata[newdata$SEX == 'I',]
infants_df <- droplevels(infants_df)
adults_df <- newdata[newdata$SEX %in% c('F','M'),]
adults_df <- droplevels(adults_df)
#adults_df["SEX"][adults_df["SEX"] == "F"] <- "ADULT"
#adults_df["SEX"][adults_df["SEX"] == "M"] <- "ADULT"
infant_vol_by_ring <- ggplot(data=infants_df,aes(x=RINGS,y=VOLUME, group=RINGS)) +
geom_boxplot(fill='lightblue') +
ylim(c(0,1100)) +
labs(title = 'Infant Volume | Rings') +
theme(plot.title = element_text(hjust = 0.5))
adult_vol_by_ring <- ggplot(data=adults_df,aes(x=RINGS,y=VOLUME, group=RINGS)) +
geom_boxplot(fill='lightblue') +
ylim(c(0,1100)) +
labs(title = 'Adult Volume | Rings') +
theme(plot.title = element_text(hjust = 0.5))
infant_weight_by_ring <- ggplot(data=infants_df,aes(x=WHOLE,y=VOLUME, group=RINGS)) +
geom_boxplot(fill='lightblue') +
ylim(c(0,400)) +
labs(title = 'Infant Whole Weight | Rings') +
theme(plot.title = element_text(hjust = 0.5))
adult_weight_by_ring <- ggplot(data=adults_df,aes(x=WHOLE,y=VOLUME, group=RINGS)) +
geom_boxplot(fill='lightblue') +
ylim(c(0,400)) +
labs(title = 'Adult Whole Weight | Rings') +
theme(plot.title = element_text(hjust = 0.5))
grid.arrange(infant_vol_by_ring,adult_vol_by_ring,infant_weight_by_ring,adult_weight_by_ring,ncol=2,nrow=2)
View(adults_df)
View(adults_df)
newdata <- mydata[mydata$RINGS<16,]
infants_df <- newdata[newdata$SEX == 'I',]
infants_df <- droplevels(infants_df)
adults_df <- newdata[newdata$SEX %in% c('F','M'),]
adults_df <- droplevels(adults_df)
#adults_df["SEX"][adults_df["SEX"] == "F"] <- "ADULT"
#adults_df["SEX"][adults_df["SEX"] == "M"] <- "ADULT"
infant_vol_by_ring <- ggplot(data=infants_df,aes(x=RINGS,y=VOLUME, group=RINGS)) +
geom_boxplot(fill='lightblue') +
ylim(c(0,1100)) +
labs(title = 'Infant Volume | Rings') +
theme(plot.title = element_text(hjust = 0.5))
adult_vol_by_ring <- ggplot(data=adults_df,aes(x=RINGS,y=VOLUME, group=RINGS)) +
geom_boxplot(fill='lightblue') +
ylim(c(0,1100)) +
labs(title = 'Adult Volume | Rings') +
theme(plot.title = element_text(hjust = 0.5))
infant_weight_by_ring <- ggplot(data=infants_df,aes(x=RINGS,y=WHOLE, group=RINGS)) +
geom_boxplot(fill='lightblue') +
ylim(c(0,400)) +
labs(title = 'Infant Whole Weight | Rings') +
theme(plot.title = element_text(hjust = 0.5))
adult_weight_by_ring <- ggplot(data=adults_df,aes(x=RINGS,y=WHOLE, group=RINGS)) +
geom_boxplot(fill='lightblue') +
ylim(c(0,400)) +
labs(title = 'Adult Whole Weight | Rings') +
theme(plot.title = element_text(hjust = 0.5))
grid.arrange(infant_vol_by_ring,adult_vol_by_ring,infant_weight_by_ring,adult_weight_by_ring,ncol=2,nrow=2)
newdata <- mydata[mydata$RINGS<16,]
infants_df <- newdata[newdata$SEX == 'I',]
infants_df <- droplevels(infants_df)
adults_df <- newdata[newdata$SEX %in% c('F','M'),]
adults_df <- droplevels(adults_df)
#adults_df["SEX"][adults_df["SEX"] == "F"] <- "ADULT"
#adults_df["SEX"][adults_df["SEX"] == "M"] <- "ADULT"
infant_vol_by_ring <- ggplot(data=infants_df,aes(x=RINGS,y=VOLUME, group=RINGS)) +
geom_boxplot(fill='lightblue') +
ylim(c(0,1100)) +
labs(title = 'Infant Volume | Rings') +
theme(plot.title = element_text(hjust = 0.5))
adult_vol_by_ring <- ggplot(data=adults_df,aes(x=RINGS,y=VOLUME, group=RINGS)) +
geom_boxplot(fill='red') +
ylim(c(0,1100)) +
labs(title = 'Adult Volume | Rings') +
theme(plot.title = element_text(hjust = 0.5))
infant_weight_by_ring <- ggplot(data=infants_df,aes(x=RINGS,y=WHOLE, group=RINGS)) +
geom_boxplot(fill='lightblue') +
ylim(c(0,400)) +
labs(title = 'Infant Whole Weight | Rings') +
theme(plot.title = element_text(hjust = 0.5))
adult_weight_by_ring <- ggplot(data=adults_df,aes(x=RINGS,y=WHOLE, group=RINGS)) +
geom_boxplot(fill='red') +
ylim(c(0,400)) +
labs(title = 'Adult Whole Weight | Rings') +
theme(plot.title = element_text(hjust = 0.5))
grid.arrange(infant_vol_by_ring,adult_vol_by_ring,infant_weight_by_ring,adult_weight_by_ring,ncol=2,nrow=2)
newdata <- mydata[mydata$RINGS<16,]
infants_df <- newdata[newdata$SEX == 'I',]
infants_df <- droplevels(infants_df)
adults_df <- newdata[newdata$SEX %in% c('F','M'),]
adults_df <- droplevels(adults_df)
#adults_df["SEX"][adults_df["SEX"] == "F"] <- "ADULT"
#adults_df["SEX"][adults_df["SEX"] == "M"] <- "ADULT"
infant_vol_by_ring <- ggplot(data=infants_df,aes(x=RINGS,y=VOLUME, group=RINGS)) +
geom_boxplot(fill='navy') +
ylim(c(0,1100)) +
labs(title = 'Infant Volume | Rings') +
theme(plot.title = element_text(hjust = 0.5))
adult_vol_by_ring <- ggplot(data=adults_df,aes(x=RINGS,y=VOLUME, group=RINGS)) +
geom_boxplot(fill='maroon') +
ylim(c(0,1100)) +
labs(title = 'Adult Volume | Rings') +
theme(plot.title = element_text(hjust = 0.5))
infant_weight_by_ring <- ggplot(data=infants_df,aes(x=RINGS,y=WHOLE, group=RINGS)) +
geom_boxplot(fill='navy') +
ylim(c(0,400)) +
labs(title = 'Infant Whole Weight | Rings') +
theme(plot.title = element_text(hjust = 0.5))
adult_weight_by_ring <- ggplot(data=adults_df,aes(x=RINGS,y=WHOLE, group=RINGS)) +
geom_boxplot(fill='maroon') +
ylim(c(0,400)) +
labs(title = 'Adult Whole Weight | Rings') +
theme(plot.title = element_text(hjust = 0.5))
grid.arrange(infant_vol_by_ring,adult_vol_by_ring,infant_weight_by_ring,adult_weight_by_ring,ncol=2,nrow=2)
newdata <- mydata[mydata$RINGS<16,]
infants_df <- newdata[newdata$SEX == 'I',]
infants_df <- droplevels(infants_df)
adults_df <- newdata[newdata$SEX %in% c('F','M'),]
adults_df <- droplevels(adults_df)
#adults_df["SEX"][adults_df["SEX"] == "F"] <- "ADULT"
#adults_df["SEX"][adults_df["SEX"] == "M"] <- "ADULT"
infant_vol_by_ring <- ggplot(data=infants_df,aes(x=RINGS,y=VOLUME, group=RINGS)) +
geom_boxplot(fill='skyblue') +
ylim(c(0,1100)) +
labs(title = 'Infant Volume | Rings') +
theme(plot.title = element_text(hjust = 0.5))
adult_vol_by_ring <- ggplot(data=adults_df,aes(x=RINGS,y=VOLUME, group=RINGS)) +
geom_boxplot(fill='maroon') +
ylim(c(0,1100)) +
labs(title = 'Adult Volume | Rings') +
theme(plot.title = element_text(hjust = 0.5))
infant_weight_by_ring <- ggplot(data=infants_df,aes(x=RINGS,y=WHOLE, group=RINGS)) +
geom_boxplot(fill='skyblue') +
ylim(c(0,400)) +
labs(title = 'Infant Whole Weight | Rings') +
theme(plot.title = element_text(hjust = 0.5))
adult_weight_by_ring <- ggplot(data=adults_df,aes(x=RINGS,y=WHOLE, group=RINGS)) +
geom_boxplot(fill='maroon') +
ylim(c(0,400)) +
labs(title = 'Adult Whole Weight | Rings') +
theme(plot.title = element_text(hjust = 0.5))
grid.arrange(infant_vol_by_ring,adult_vol_by_ring,infant_weight_by_ring,adult_weight_by_ring,ncol=2,nrow=2)
newdata <- mydata[mydata$RINGS<16,]
infants_df <- newdata[newdata$SEX == 'I',]
infants_df <- droplevels(infants_df)
adults_df <- newdata[newdata$SEX %in% c('F','M'),]
adults_df <- droplevels(adults_df)
infant_vol_by_ring <- ggplot(data=infants_df,aes(x=RINGS,y=VOLUME, group=RINGS)) +
geom_boxplot(fill='skyblue') +
ylim(c(0,1100)) +
labs(title = 'Infant Volume | Rings') +
theme(plot.title = element_text(hjust = 0.5))
adult_vol_by_ring <- ggplot(data=adults_df,aes(x=RINGS,y=VOLUME, group=RINGS)) +
geom_boxplot(fill='maroon') +
ylim(c(0,1100)) +
labs(title = 'Adult Volume | Rings') +
theme(plot.title = element_text(hjust = 0.5))
infant_weight_by_ring <- ggplot(data=infants_df,aes(x=RINGS,y=WHOLE, group=RINGS)) +
geom_boxplot(fill='skyblue') +
ylim(c(0,400)) +
labs(title = 'Infant Whole Weight | Rings') +
theme(plot.title = element_text(hjust = 0.5))
adult_weight_by_ring <- ggplot(data=adults_df,aes(x=RINGS,y=WHOLE, group=RINGS)) +
geom_boxplot(fill='maroon') +
ylim(c(0,400)) +
labs(title = 'Adult Whole Weight | Rings') +
theme(plot.title = element_text(hjust = 0.5))
grid.arrange(infant_vol_by_ring,adult_vol_by_ring,infant_weight_by_ring,adult_weight_by_ring,ncol=2,nrow=2)
# DO NOT ADD OR REVISE CODE HERE
knitr::opts_chunk$set(echo = FALSE, eval = TRUE)
# a) Load the ggplot2 and gridExtra packages.
library(ggplot2)
library(gridExtra)
library(knitr)
# b) Use read.csv() to read the abalones.csv into R, assigning the data frame to "mydata."
mydata <- read.csv("abalones.csv", sep = ",", stringsAsFactors = TRUE)
# c) Use the str() function to verify the structure of "mydata." You should have 1036 observations
# of eight variables.
str(mydata)
# d) Define two new variables, VOLUME and RATIO. Use the following statements to define VOLUME and
# RATIO as variables appended to the data frame "mydata."
mydata$VOLUME <- mydata$LENGTH * mydata$DIAM * mydata$HEIGHT
mydata$RATIO <- mydata$SHUCK / mydata$VOLUME
summary(mydata)
s1_table <- table(mydata$CLASS,mydata$RINGS)
#rows = class, columns = rings
s1_table
q1_table <- table(mydata$SEX,mydata$CLASS)
q1_table
q1_table_with_margin <- addmargins(q1_table, FUN = sum)
q1_table_with_margin
barplot(q1_table,
beside=TRUE,
legend = rownames(q1_table),
col = c("darkred", "darkblue", "darkgreen"),
main = 'CLASS membership, SEX-differentiated'
)
set.seed(123)
list_of_numbers <- seq(1,1036)
sample_list <- sample(x = list_of_numbers, size = 200, replace=FALSE)
sample_df <- mydata[sample_list,]
plot(sample_df[, 2:6])
ggplot(mydata, aes(x=WHOLE, y=VOLUME, color=CLASS)) +
geom_point(size=1) +
labs(title = 'WHOLE vs VOLUME by CLASS') +
theme(plot.title = element_text(hjust = 0.5))
ggplot(mydata, aes(x=WHOLE, y=VOLUME, color=CLASS)) +
geom_point(size=1) +
labs(title = 'WHOLE vs VOLUME by CLASS w/ smooth') +
theme(plot.title = element_text(hjust = 0.5)) +
geom_smooth(method='lm')
mydata$ratio_shuck_whole = mydata$SHUCK/mydata$WHOLE
max_ratio <- mydata$ratio_shuck_whole[which.max(mydata$ratio_shuck_whole)]
#mydata$ratio_shuck_whole[810]
#176.125 - 0 = x2-x1, 99 - 0 = y2-y1,
ggplot(mydata, aes(x=WHOLE, y=SHUCK, color=CLASS)) +
geom_point(size=1) +
labs(title = 'SHUCK vs WHOLE by CLASS') +
theme(plot.title = element_text(hjust = 0.5)) +
geom_abline(slope = max_ratio)
ggplot(mydata, aes(x=WHOLE, y=SHUCK, color=CLASS)) +
geom_point(size=1) +
labs(title = 'SHUCK vs WHOLE by CLASS w/ Smooth') +
theme(plot.title = element_text(hjust = 0.5)) +
geom_smooth(method='lm')
histograms <- ggplot(mydata,aes(x=RATIO,fill=SEX)) +
geom_histogram(bins=14,right=FALSE) +
facet_grid(~ SEX) +
theme(axis.title.x=element_blank()) +
labs(title = 'Ratio Histograms') +
theme(plot.title = element_text(hjust = 0.5))
boxes <- ggplot(mydata,aes(x=factor(0),y=RATIO,fill=SEX)) +
geom_boxplot(width=.5) +
facet_grid(. ~ SEX) +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
labs(title = 'Ratio Boxplots') +
theme(plot.title = element_text(hjust = 0.5))
qqs <- ggplot(mydata,aes(sample=RATIO,color=SEX)) +
geom_qq() +
geom_qq_line(color='black') +
facet_grid(. ~ SEX) +
labs(title = 'Ratio QQ Plot') +
theme(plot.title = element_text(hjust = 0.5))
grid.arrange(histograms,boxes,qqs,nrow=3)
female_ratio <- mydata[mydata$SEX == 'F',]['RATIO']
female_ratio_outliers <- boxplot.stats(female_ratio$RATIO,coef=1.5,do.out=TRUE)
female_ratio_outlier_df <- mydata[mydata$RATIO %in% female_ratio_outliers$out,]
kable(female_ratio_outlier_df,"pipe",caption = "Female Outliers for RATIO")
male_ratio <- mydata[mydata$SEX == 'M',]['RATIO']
male_ratio_outliers <- boxplot.stats(male_ratio$RATIO,coef=1.5,do.out=TRUE)
male_ratio_outlier_df <- mydata[mydata$RATIO %in% male_ratio_outliers$out,]
kable(male_ratio_outlier_df,"pipe",caption = "Male Outliers for RATIO")
infant_ratio <- mydata[mydata$SEX == 'I',]['RATIO']
infant_ratio_outliers <- boxplot.stats(infant_ratio$RATIO,coef=1.5,do.out=TRUE)
infant_ratio_outlier_df <- mydata[mydata$RATIO %in% infant_ratio_outliers$out,]
kable(infant_ratio_outlier_df,"pipe",caption = "Infant Outliers for RATIO")
s4_boxes_volume <- ggplot(mydata,aes(y=VOLUME,fill=CLASS)) +
geom_boxplot() +
labs(title = 'VOLUME by CLASS') +
theme(plot.title = element_text(hjust = 0.5))
s4_boxes_whole <- ggplot(mydata,aes(y=WHOLE,fill=CLASS)) +
geom_boxplot() +
labs(title = 'WHOLE by CLASS') +
theme(plot.title = element_text(hjust = 0.5))
s4_scatter_volume <- ggplot(mydata, aes(x=RINGS, y=VOLUME, color=CLASS)) +
geom_point(size=1) +
labs(title = 'VOLUME vs RING by CLASS') +
theme(plot.title = element_text(hjust = 0.5))
s4_scatter_whole <- ggplot(mydata, aes(x=RINGS, y=WHOLE, color=CLASS)) +
geom_point(size=1) +
labs(title = 'WHOLE vs RING by CLASS') +
theme(plot.title = element_text(hjust = 0.5))
grid.arrange(s4_boxes_volume,s4_boxes_whole,
s4_scatter_volume, s4_scatter_whole,
ncol=2)
library(tidyverse)
library(glue)
means_df <- aggregate(cbind(VOLUME, SHUCK, RATIO) ~ SEX + CLASS, mydata, FUN=mean)
volume_df <- means_df[c('SEX','CLASS','VOLUME')]
volume_matrix <- pivot_wider(volume_df,names_from=CLASS,values_from=VOLUME)
volumes <- list('Volume Table',volume_matrix)
volumes
shuck_df <- means_df[c('SEX','CLASS','SHUCK')]
shuck_matrix <- pivot_wider(shuck_df,names_from=CLASS,values_from=SHUCK)
shucks <- list('Shuck Table',shuck_matrix)
shucks
ratio_df <- means_df[c('SEX','CLASS','RATIO')]
ratio_matrix <- pivot_wider(ratio_df,names_from=CLASS,values_from=RATIO)
ratios <- list('Ratio Table',ratio_matrix)
ratios
ratio_plot <- ggplot(data=ratio_df,aes(x=CLASS, y=RATIO,color=SEX,group=SEX)) +
geom_line() +
geom_point(size=2) +
labs(title = 'Mean Ratio per CLASS') +
theme(plot.title = element_text(hjust = 0.5))
volume_plot <- ggplot(data=volume_df,aes(x=CLASS, y=VOLUME,color=SEX,group=SEX)) +
geom_line() +
geom_point(size=2) +
labs(title = 'Mean Volume per CLASS') +
theme(plot.title = element_text(hjust = 0.5))
shuck_plot <- ggplot(data=shuck_df,aes(x=CLASS, y=SHUCK,color=SEX,group=SEX)) +
geom_line() +
geom_point(size=2) +
labs(title = 'Mean Shuck Per CLASS') +
theme(plot.title = element_text(hjust = 0.5))
grid.arrange(ratio_plot,volume_plot, shuck_plot, ncol=2, nrow=2)
newdata <- mydata[mydata$RINGS<16,]
infants_df <- newdata[newdata$SEX == 'I',]
infants_df <- droplevels(infants_df)
adults_df <- newdata[newdata$SEX %in% c('F','M'),]
adults_df <- droplevels(adults_df)
infant_vol_by_ring <- ggplot(data=infants_df,aes(x=RINGS,y=VOLUME, group=RINGS)) +
geom_boxplot(fill='skyblue') +
ylim(c(0,1100)) +
labs(title = 'Infant Volume | Rings') +
theme(plot.title = element_text(hjust = 0.5))
adult_vol_by_ring <- ggplot(data=adults_df,aes(x=RINGS,y=VOLUME, group=RINGS)) +
geom_boxplot(fill='maroon') +
ylim(c(0,1100)) +
labs(title = 'Adult Volume | Rings') +
theme(plot.title = element_text(hjust = 0.5))
infant_weight_by_ring <- ggplot(data=infants_df,aes(x=RINGS,y=WHOLE, group=RINGS)) +
geom_boxplot(fill='skyblue') +
ylim(c(0,400)) +
labs(title = 'Infant Whole Weight | Rings') +
theme(plot.title = element_text(hjust = 0.5))
adult_weight_by_ring <- ggplot(data=adults_df,aes(x=RINGS,y=WHOLE, group=RINGS)) +
geom_boxplot(fill='maroon') +
ylim(c(0,400)) +
labs(title = 'Adult Whole Weight | Rings') +
theme(plot.title = element_text(hjust = 0.5))
grid.arrange(infant_vol_by_ring,adult_vol_by_ring,infant_weight_by_ring,adult_weight_by_ring,ncol=2,nrow=2)
